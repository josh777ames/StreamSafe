import time
import requests
from sourcing.ScriptScraper import ScriptScraper
from sourcing.SumScraper import SumScraper
from GeminiAnalysis import GeminiAnalysis
import os
import sqlite3

# Note: this does not add categories to triggers as those were a last minute addition. In future updates categories will be implemented into the automated loop, but for now they must be added manually. 

def insert_movie_triggers(imdb_id, title, trigger_dict, db_path="movies.db"):

    """
    Store movie and its AI-predicted triggers into the SQLite database.
    
    Parameters:
        imdb_id (str): IMDb ID of the movie
        title (str): Movie title
        trigger_dict (dict): Dictionary of trigger labels and values (1 or 0)
        db_path (str): Path to your SQLite database
    """
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()

    # Step 1: Insert movie into movies table if it doesn't already exist
    cursor.execute("""
        INSERT OR IGNORE INTO movies (imdb_id, title)
        VALUES (?, ?)
    """, (imdb_id, title))

    # Step 2: Get movie_id from the movies table
    cursor.execute("SELECT id FROM movies WHERE imdb_id = ?", (imdb_id,))
    movie_id = cursor.fetchone()[0]  # Guaranteed to exist due to INSERT OR IGNORE

    # Step 3: Insert triggers using normalized structure
    for trigger_name, value in trigger_dict.items():
        # Ensure the trigger exists in trigger_definitions
        cursor.execute("SELECT id FROM trigger_definitions WHERE name = ?", (trigger_name.strip(),))
        result = cursor.fetchone()

        if result:
            trigger_id = result[0]
        else:
            # Insert new trigger definition if missing
            cursor.execute("INSERT INTO trigger_definitions (name) VALUES (?)", (trigger_name.strip(),))
            trigger_id = cursor.lastrowid

        # Insert or update the trigger entry
        cursor.execute("""
            INSERT OR REPLACE INTO triggers (movie_id, trigger_id, value)
            VALUES (?, ?, ?)
        """, (movie_id, trigger_id, int(value)))

    conn.commit()
    conn.close()


TMDB_API_KEY = os.getenv("TMDB_API_KEY")
TMDB_SEARCH_URL = "https://api.themoviedb.org/3/search/movie"
TMDB_DETAILS_URL = "https://api.themoviedb.org/3/movie/{}"

script_scraper = ScriptScraper()
sum_scraper = SumScraper()
gpt = GeminiAnalysis()

def search_tmdb(title, year=None):
    params = {
        "api_key": TMDB_API_KEY,
        "query": title,
        "language": "en-US",
    }
    response = requests.get(TMDB_SEARCH_URL, params=params)
    results = response.json().get("results", [])
    for movie in results:
        if movie["title"].lower() == title.lower():
            if not year or str(movie.get("release_date", "")).startswith(str(year)):
                return movie

    return results[0] if results else None

def get_movie_details(tmdb_id):
    response = requests.get(TMDB_DETAILS_URL.format(tmdb_id), params={"api_key": TMDB_API_KEY})
    return response.json()

def process_movies(movie_title_list):
    for title in movie_title_list:
        print(f"Processing: {title}")
        try:
            movie_data = search_tmdb(title)
            if not movie_data:
                print(f"TMDB match not found for '{title}'")
                continue

            tmdb_id = movie_data['id']
            details = get_movie_details(tmdb_id)
            imdb_id = details.get("imdb_id")
            director = "Unknown"

            # Fetch director from TMDB
            credits_url = f"https://api.themoviedb.org/3/movie/{tmdb_id}/credits"
            credits_resp = requests.get(credits_url, params={"api_key": TMDB_API_KEY}).json()
            for crew in credits_resp.get("crew", []):
                if crew["job"] == "Director":
                    director = crew["name"]
                    break

            short_imdb_id = imdb_id[2:] if imdb_id and imdb_id.startswith("tt") else imdb_id

            # Get script
            script = script_scraper.sfy_get(title, short_imdb_id)
            if not script:
                script = script_scraper.dailyscript_get(short_imdb_id)

            if not script or "error" in script:
                print(f"No script found for '{title}'")
                continue

            # Get summary
            wiki_summary = sum_scraper.get_wikipedia_summary(title, director, imdb_id)
            wiki_text = "\n\n".join([f"{k}\n{v}" for k, v in wiki_summary.items()])

            if script:
                trigger_dict = gpt.RunAnalysis(title, wiki_text, script)
            if trigger_dict:
                insert_movie_triggers(imdb_id, title, trigger_dict)

        except Exception as e:
            print(f"Error processing '{title}': {e}")

        # Respect API rate limits
        time.sleep(0.5)

# List of movies to loop through (note: not every movie was ran due to Gemini's monthly and daily rate limits)
movie_title_list = ("Sounder", "South Park: Bigger", "Longer and Uncut", "Spaceballs", "Spanglish", "Spare Me", "Sphere", "Spider-Man", "Spider-Man", "Stagecoach", "Stalag 17", "Star Wars aka Star Wars: Episode IV - A New Hope", "Star Wars: Episode I - The Phantom Menace", "Star Wars: Episode II - Attack of the Clones", "Star Wars: Episode III - Revenge of the Sith", "Star Wars: Episode V - The Empire Strikes Back", "Star Wars: Episode VI - Return of the Jedi", "Starman", "Starship Troopers", "State and Main", "Stepmom", "Sting", "The", "Strange Days", "Sugar & Spice", "Sunset Blvd.", "Superman", "Superman", "Sweet Hereafter", "The", "Swingers", "THE X-MEN", "THX 1138", "Talented Mr. Ripley", "Taxi Driver", "Terminator", "Terminator 2: Judgment Day", "The Abyss", "The Adventures of Buckaroo Banzai Across the 8th Dimension", "The African Queen", "The Age of Innocence transcript", "The American President", "The Anniversary Party", "The Apartment", "The Avengers", "The Bachelor Party", "The Battle of Algiers", "The Big Blue", "The Bodyguard", "The Corruptor", "The Crow", "The Crow - City Of Angels", "The Crying Game", "The Day The Clown Cried", "The Doors", "The Fabulous Baker Boys", "The French Connection", "The Game", "The Game", "The Godfather", "The Godfather: Part II", "The Goonies", "The Grifters", "The Jackie Robinson Story", "The Lion in Winter", "The Matrix transcript", "The Matrix", "The Messenger: The Story Of Joan Of Arc", "The Pursuit Of Happyness transcript", "The Queen", "The Shawshank Redemption", "The Sixth Sense", "The Straight Story", "The Swimmer", "The Truman Show", "The Usual Suspects", "Thelma & Louise", "There's Something About Mary", "They", "Thin Man", "The", "Thing Called Love", "The", "Thing", "The", "Thir13en Ghosts", "Thirteen Days", "Three Kings", "Time Machine", "The", "Time Machine", "The", "Titanic", "To Sleep With Anger", "Tomb Raider", "Tomorrow Never Dies", "Top Gun", "Total Recall", "Toy Story", "Traffic", "Training Day", "Trainspotting", "Tremors", "Tron", "True Believer", "True Lies", "True Romance", "Twelve Monkeys", "Twin Peaks: Fire Walk with Me", "U-Turn", "Unbreakable", "Under Fire", "Unforgiven", "V for Vendetta", "Verdict", "The", "Vertigo", "Very Bad Things", "Viridiana", "Virtuosity", "Wag the Dog", "Wall Street", "What Lies Beneath", "When Harry Met Sally... transcript", "When a Stranger Calls", "Whiplash", "White Angel", "White Squall", "Who Framed Roger Rabbit", "Wild Bunch", "The", "Wild Things", "Wild at Heart", "Withnail and I transcript", "Witness", "Wizard of Oz", "The", "Wonder Boys", "World Is Not Enough", "The", "X Files", "The", "You've Got Mail", "Zodiac", "Zulu Dawn", "13 Ghosts", "16 Blocks", "One Eight Seven", "25th Hour", "2001 Maniacs", "2010 The Odyssey Continues", "3 Kings", "40 Year Old Virgin", "Eight Legged Freaks", "8 Mile", "Above the Law", "Absolute Power", "Adaptation", "Adaptation", "The Addams Family", "An Affair to Remember", "After School Special", "After the Truth", "Alfie", "American Splendor", "An Officer and a Gentleman", "Anatomy of a Murder", "Angel Eyes", "Any Given Sunday", "Apache Drums", "Arac Attack", "Armageddon", "Asylum", "Awakenings", "Bad Boys", "Bad Lieutenant", "Barbershop", "Batman Begins", "Battle for the Planet of the Apes part 1", "Battle for the Planet of the Apes part 2", "Beauty Shop", "Being Human", "Beneath the Planet of the Apes", "The Big Easy", "The Big Sleep", "The Birds", "Blood Relations The Sun Wars", "Blood Work", "The Blues Brothers", "Body Heat", "The Bodyguard", "Bonfire of the Vanities", "Born on the Fourth of July", "Born on the Fourth of July", "Born on the Fourth of July", "Born on the Fourth of July", "The Bourne Supremacy", "Boy Who Never Slept", "Break", "Breakdown", "Brick", "Broken Arrow", "Call Northside 777", "Call Northside 777", "Capote", "Casablanca", "Catwoman", "Cellular", "Charlie's Angels", "The Chronicles of Narnia: The Lion", "the Witch and the Wardrobe", "City of Joy", "A Clockwork Orange", "Close Encounters of The Third Kind", "Close Encounters of The Third Kind", "Clue", "Clue", "Cobb", "Collateral", "Collateral Damage", "Commando", "Committed", "Confessions of a Dangerous Mind", "Confidence", "The Contest", "Cortes", "Courage Under Fire", "Cradle to the Grave", "Crash", "Crazylove", "Crime Spree", "The Crow: 2037 A New World of Gods and Monster", "The Crying Game", "Custody", "Dances With Wolves", "Death to Smoochy", "Deceptions", "Duel", "The Devil's Advocate", "Diamond Dead", "Diamond Dead", "Diamond Dead", "Die Hard 2", "The Distinguished Gentleman", "Doom", "A Dry White Season", "Edward Ford", "Eight Legged Freaks", "Elizabethtown", "Encrypt", "Equilibrium", "Equilibrium", "Escape from the Planet of the Apes The Secret of the Planet of the Apes part 1", "Escape from the Planet of the Apes The Secret of the Planet of the Apes part 2", "Eternal Sunshine of the Spotless Mind", "Executive Decision", "F", "Fallen", "Far From Heaven", "The Flintstones", "Fortune Cookie", "Freaked", "Freddy vs. Jason", "Freddy vs. Jason", "From Here To Eternity", "From Here To Eternity", "The Fugitive", "Fun With Dick and Jane Part 1", "Fun With Dick and Jane Part 2", "Game 6", "Get Carter", "Get Rich or Die Trying", "The Getaway", "Giant", "Girl With a Pearl Earring", "Glory Road", "Go To Hell", "The Godfather III", "The Gods of Comedy", "Good Fellas", "Good Night", "and Good Luck", "A Goofy Movie", "The Goonies", "Gothika", "Halloween: Resurrection", "Hard to Kill", "Hardware", "Hardware", "Heat", "Heist", "Hellraiser: Bloodline", "Hellraiser: Hellseeker", "Hellraiser: Hellseeker", "Hellraiser: Deader", "Hellraiser: Deader", "The Hills Have Eyes", "The Hitcher", "Holes", "Hook", "Hook", "Horror Inc.", "Hotel Rwanda", "Hudson Hawk", "Human Nature", "The Hundred Year Winter", "The Hudsucker Proxy", "Hustle & Flow", "I", "Robot", "The Imitation Game", "In The Heat of the Night", "In The Mouth of Madness", "Indiana Jones and the Raiders Of The Lost Ark", "Innerspace", "Inside Man", "Interview with the Vampire", "Inventing the Abbotts", "The Island", "The Island of Dr. Moreau", "The Island of Dr. Moreau", "Italian Job", "The Jacket", "Jade", "Jeepers Creepers 2", "Jimmy and Judy", "Karate Kid", "Katie's Choice", "Kids", "Kids in the Hall: Brain Candy", "Killing Charlie Kaufman", "Kiss", "Kiss", "Bang", "Bang", "Kiss of the Spider Woman", "Labyrinth", "Land of the Dead", "Last Action Hero", "Last Action Hero", "The Last Bachelor", "The Last Boy Scout", "The Last Samurai", "The Last Samurai", "Legally Blonde", "Lethal Weapon II", "Lethal Weapon 4", "Liar", "Liar", "Liberty Street", "License to Drive", "Life on Liberty Street", "The Life of David Gale", "The Lion King", "Little Black Book", "Lost in Translation", "Luna", "Malibu's Most Wanted", "The Maltese Falcon", "Man on Fire", "Man Trouble", "The Man Who Knew Too Much", "The Manchurian Candidate", "Mandingo", "Maria Full of Grace", "Matchstick Men", "The Matrix", "Maverick", "Mean Girls", "Memphis Belle", "Miami Vice", "Midnight Express", "Mighty Joe Young", "Million Dollar Baby", "Monster's Ball", "Mr. And Mrs. Smith", "Mr. Holland's Opus", "Munich", "Munich", "Natural Born Killers", "Near Dark", "New York Minute", "Newsies", "Nichts als die Wahrheit", "Nightmare on Elm Street 3: Dream Warriors", "Nightmare on Elm Street 6: Freddy's Dead: The Final Nightmare", "North By Northwest", "Now or Never", "Ocean's Eleven", "An Officer and a Gentleman", "Office Space", "On Air", "The Omen", "One Eight Seven", "Only Angels Have Wings", "Out of Sight", "Outbreak", "The Pacifier", "Paradox", "Paths of Glory", "The Perfect Neighbor", "The Perfect Stranger", "A Perfect World", "Planet of the Apes part 1", "Planet of the Apes part 2", "Planet of the Apes part 3", "Planet of the Apes", "Planet of the Apes part 1", "Planet of the Apes part 2", "Planet of the Men part 1", "Planet of the Men part 2", "Planet of the Apes Revisited part 1", "Planet of the Apes Revisited part 2", "Beneath the Planet of the Apes", "The Secret of the Planet of the Apes Escape from the Planet of the Apes) part 1", "The Secret of the Planet of the Apes Escape from the Planet of the Apes) part 2", "Escape from the Planet of the Apes part 1", "Escape from the Planet of the Apes part 2", "Conquest of the Planet of the Apes", "Battle for the Planet of the Apes part 1", "Battle for the Planet of the Apes part 2", "Return to the Planet of the Apes part 1", "Return to the Planet of the Apes part 2", "Planetfall", "Poltergeist", "The Poseidon Adventure", "The Poseidon Adventure", "Possession", "The Postman", "The Power of One", "Prime Directive", "The Private Life of Sherlock Homes", "The Punisher", "The Punisher", "Queen of the Damned", "Quills", "Quiz Show", "Rear Window", "Red Planet", "Rent", "Rent", "The Replacements", "Return to the Planet of the Apes part 1", "Return to the Planet of the Apes part 2", "The Ringer", "Robin Hood", "The Prince of Thieves", "Robocop", "Rock & Rule", "Rough Diamonds", "The Royal Tenenbaums", "The Rules of Attraction", "Saboteur", "Save the Last Dance", "A Scanner Darkly", "Scarface", "The Secret of the Planet of the Apes Escape from the Planet of the Apes) part 1", "The Secret of the Planet of the Apes Escape from the Planet of the Apes) part 2", "Secret Window", "Shadow of the Vampire", "Sideways", "Slackers", "Slash", "Slay the Dreamer", "Sleepaway Camp III", "Snatch", "Something Borrowed", "Something's Gotta Give", "Space Cowboys", "Spanglish", "Spartan", "Speed", "Special", "The Spirit of St. Louis", "Star Trek 10: Nemesis", "Stay", "Stir of Echos", "Strangers on a Train", "Stuart Little 2", "SuperFights", "Superman", "Suspect Zero", "Sweet November", "Swordfish", "Syriana", "Taking Lives", "Tarzan's Secret Treasure", "Thief", "The Thin Red Line", "The Thing", "Thir13en Ghosts", "Thirteen Ghosts", "This Boy's Life", "Three Days of the Condor", "Three Kings", "Three Men and a Baby", "The Three Musketeers", "Thunderheart", "Ticker", "Timeline", "Timeline", "Tin Cup", "Tin Men", "Tombstone", "Training Day", "Transformers", "The Treasure Of Sierra Madre", "Tripping Forward", "Troy", "Troy", "True Crime", "True Romance", "Twins", "Untitled 50 Cent Project", "Vagrant", "Vikings", "Virtuosity", "Waking up the Day", "Walk The Line", "A Walk to Remember", "Warm Springs", "Warriors", "The Wedding Crashers", "The Wedding Date", "When Harry Met Sally", "Wild Things: Diamonds in the Rough", "Wild", "Wild West", "Wish List", "The Witches of Eastwick", "X-Men", "X-men 2", "X2", "You'll Never Die In This Town Again", "Zapper", "531", "10 Things I Hate About You", "10,000 B. C.", "12 And Holding", "12 Angry Men", "12 Monkeys", "12 Years a Slave", "13 Days", "13 Ghosts", "1492: Conquest of Paradise:", "15 Minutes", "16 Blocks", "2001: A Space Odyssey", "20th Century Woman", "25th Hour", "3 Kings", "40 Year Old Virgin", "48 Hours", "The 5th Element", "8 Mile", "8 Millimeter", "8 MM", "84 Charlie MoPic", "The 9th Gate", "Above the Law", "Absolute Power", "The Abyss", "Ace Ventura: Pet Detective", "Adaptation", "The Addams Family", "Adventureland", "The Adventures of Ford Fairlane", "An Affair to Remember", "Affliction", "The African Queen", "Airforce One", "Airplane II: The Sequel", "Airplane!", "Alfie", "Ali", "Alien", "Alien Nation", "Alien vs. Predator", "Aliens", "All About Eve", "All The King's Men", "All The President's Men", "Almost Famous", "Amadeus", "American Beauty", "American Graffiti", "American Bullshit", "American Madness", "American Outlaws", "American Pie", "The American President", "American Psycho", "American Splendor", "An American Werewolf In London", "An American Werewolf In Paris", "Analyse That", "Analyse This", "Anatomy of a Murder", "Angel Eyes", "Annie Hall", "The Anniversary Party", "Antitrust", "Antz", "Any Given Sunday", "Apache Drums", "The Apartment", "Apocalypse Now", "Apocalypse Now: Redux", "Apt Pupil", "Arac Attack", "Armstrong", "Arrival", "As Good As It Gets", "Assassins", "The Assignment", "Asylum no info", "At First Sight", "Austin Powers 2: The Spy Who Shagged Me", "Austin Powers: International Man of Mystery", "Autumn In New York", "The Avengers", "Awakenings", "Babel", "Bachelor Party", "Backdraft", "Bad Boys", "Bad Day At Black Rock", "Bad Lieutenant", "Bad Santa", "Badlands", "Barry Lyndon", "Barton Fink", "Basic", "Basic Instinct", "Batman", "Batman 2", "Batman Begins", "Batman Forever", "Batman Returns", "The Battle of Algiers", "The Battle of Shaker Heights", "Beautiful Girls", "Beauty Shop", "Beavis and Butt-head Do America", "Bedlam", "Beetle Juice", "Before Sunset", "Being Human", "Being John Malkovich", "Being There", "The Believer", "Belle", "Beloved", "Below", "Beowulf & Grendal", "The Big Blue", "The Big Easy", "Big Eyes", "Big Fish", "The Big Lebowski", "The Big Sick", "The Big Sleep", "Big Trouble in Little China II", "The Bijou", "Birdman", "The Birds", "Birth of a Nation", "Birthday Girl", "The Black Dahlia", "Black Rain", "Black Snake Moan", "Blade", "Blade II", "Blade Runner", "Blade Trinity", "Blair Witch II", "The Blast from the Past", "Blood Diamond", "Blood Relations The Sun Wars", "Blood Simple", "Blood Work", "Blow", "Blue Hotel", "Blue Velvet", "The Blues Brothers", "Bodies", "Rest & Motion", "Body Heat", "Body of Evidence", "The Body Snatcher", "The Bodyguard", "Bones", "Bonfire of the Vanities", "The Boondock Saints", "Born on the Fourth of July", "Bottle Rocket", "Bound", "The Bourne Identity", "The Bourne Supremacy", "The Bourne Ultimatum", "The Boxtrolls", "The Boy Next Door", "Boy Who Never Sleptboy who never slept", "Boyhood", "Braveheart", "Brazil", "Breach", "Breakno info", "Breakdown", "Breakfast At Tiffany's", "The Breakfast Club", "Bringing Out the Dead", "Bringing Up Baby", "Broadcast News", "Brooklyn", "Bruce Almighty", "The Bucket List", "Buffy the Vampire Slayer", "Bull Durham", "Butch Cassidy and The Sundance Kid", "The Butler", "The Butterfly Effect", "The Cable Guy", "Call Me By Your Name", "Call Northside 777", "Calvary", "El Cantante", "Capote", "Captain Phillips", "Carnivore", "Carol", "Casablanca", "Casino", "Casino Royale", "Cast Away", "The Cat People", "Catwoman", "The Cell", "Cellular", "Cellular", "Changeling", "Charade", "Charlie's Angels", "Chasing Amy", "Chasing Sleep", "Children of Men", "Chinatown", "A Christmas Story", "Chronicle", "The Chronicles of Narnia: The Lion", "the Witch and the Wardrobe", "The Cider House Rules", "The Cincinnati Kid", "Cinema Paradiso", "Citizen Kane", "Citizen Kane", "City of Joy", "Clerks", "Cliffhanger", "A Clockwork Orange", "Cobb", "Code Of Silence", "Cold Mountain", "Collateral", "Collateral Damage", "The Comedian", "Committed", "Conan", "Confidence", "Conquest of Paradise: 1492", "Conspiracy Theory", "The Cooler", "Copycat", "The Corruptor", "Courage Under Fire", "Cradle to the Grave", "Crank", "Crash", "Crazy Love", "Crazylove", "Crime Spree", "Cross of Iron", "Croupier", "The Crow", "Crow 3: Resurrection", "The Crow Salvation", "The Crowded Room", "Cruel Intentions", "The Crying Game", "Curse of the Cat People", "Dances With Wolves", "Dark Angel - Pilot", "Dark City", "Dark Star", "Darkman", "The Day The Earth Stood Still", "The Day the Clown Cried", "Days of Heaven", "Dead Poets Society", "Death to Smoochy", "Deep Cover", "Deep Rising", "The Deer Hunter", "Defiance", "Deliverance", "Demolition Man", "The Departed", "Detroit Rock City", "Devil In a Blue Dress", "The Devil Wears Prada", "The Devil's Advocate", "Die Hard 2", "Diner", "The Disaster Artist", "The Distinguished Gentleman", "Disturbia", "The Diving Bell and the Butterfly", "Django Unchained", "Doctor Zhivago", "Dog Day Afternoon", "Dog Day Afternoon", "Domino", "Donnie Brasco", "Donnie Darko", "Doom", "The Doors", "The Doors of Perception", "Double Indemnity", "Downsizing", "Dragon Slayer", "The Dragons of Krull", "Drop Dead Gorgeous", "A Dry White Season", "Duchess", "Duck Soup", "Dumb and Dumber", "Dunkirk", "Ed TV", "Ed Wood", "Edward Scissorhands", "The Egyptian", "Eight Legged Freaks", "Eight Millimeter", "Eight Scenes from the life of Hank Williams", "El Cantante", "El Laberinto del Fauno", "El Mariachi", "Election", "The Electric Horseman", "The Elephant Man", "Elf", "Elizabeth: The Golden Age", "Elizabethtown", "Elle", "Empire of the Sun", "The End of the Tour", "Enemy of the State", "The English Patient", "Entrapment", "Equilibrium", "Equity", "Erik the Viking", "Erin Brockovich", "Eternal Sunshine Of The Spotless Mind", "Even Cowgirls Get The Blues", "Event Horizon", "Ex Machina", "Excalibur", "Executive Decision", "The Fabulous Baker Boys", "Face/Off", "The Fact of Murderinfo", "The Faculty", "Fallen", "The Family Man", "The Fantastic Four", "Far From The Maddening Crowd", "Fargo", "Fargo", "Fast Times at Ridgemont High", "Fatal Instinct", "The Fault in our Stars", "Fear and Loathing in Las Vegas", "Feast - early draft", "Feast - revised draft", "Fences", "Ferris Bueller's Day Off", "Field of Dreams", "Fifty Violins", "Fight Club", "Final Analysis", "Final Destination", "Final Destination 2", "First Man", "First They Killed My Father", "The Fisher King", "Five Easy Pieces", "Five Feet and Rising", "Fletch", "Flight", "Flight Plan", "The Flintstones", "The Florida Project", "Forbidden Planet", "Ford Fairlane wikipedia", "Forrest Gump", "Foundation", "The Founder", "Four Feathers", "Four Rooms", "Foxcatcher", "Fracture", "Frances", "Frankenstein", "Freaked", "Freddy vs. Jason", "Freddy's Dead: The Final Nightmare", "The French Connection", "Frequency", "Friday the 13th", "Friday The 13th Part 8: Jason Takes Manhatten", "Friday the 13th Part 10: Jason X", "From Dusk Till Dawn", "From Russia With Love", "Frost/Nixon", "Frozen River", "The Fugitive", "Fun With Dick and Jane Part 1", "Fun With Dick and Jane Part 2", "Funny People", "Fury", "The Game", "Game 6", "Gandhi", "Gang Related", "Garden State", "Gateway", "Gattaca", "Get Carter", "Get Him To The Greek", "Get On Up", "Get Rich or Die Trying", "Get Shorty", "The Getaway", "Ghost", "The Ghost and the Darkness", "Ghost Ship", "Ghost World", "Giant", "Glengarry Glen Ross", "Glory Road", "The Godfather", "The Godfather Part 2", "Gods and Monsters", "Gold", "Goldeneye", "Goldfinger", "Gone Girl", "Gone in Sixty Seconds", "Gone With The Wind", "Good Luck Chuck", "Good Night", "and Good Luck", "Good Will Hunting", "A Good Year", "Goodfellas", "The Goonies", "Gothika", "The Graduate", "Le Grand bleu", "The Grand Budapest Hotel", "Grand Hotel", "The Grapes of Wrath", "Gravity", "The Great Train Robbery", "The Greatest Muppet Movie of All Time", "The Grifters", "Grosse Pointe Blank", "Groundhog Day", "The Grudge", "Halloween", "Halloween 6: The Curse of Michael Myers", "Halloween: Resurrection", "Hannah and Her Sisters", "Hannibal", "Hanssen", "Happy Birthday", "Wanda June", "Happy Campers", "Happy-Go-Lucky", "A Hard Day's Night", "Hard Rain", "Hard to Kill", "Hardcore", "Harold and Kumar go to White Castle", "Harold and Maude", "Harry Potter And The Order of the Phoenix", "The Hateful Eight", "The Haunting", "The Haunting of Hill House", "Havoc 2: Normal Adolescent Behavior", "Heat", "Heathers", "Heavy Metal", "The Hebrew Hammer", "Heist", "Hellboy", "Hellraiser", "Hellbound: Hellraiser II", "The Help", "Henry Fool", "Hero", "Heros: Genesis", "He's Just Not That Into You", "Hider In The House", "High Fidelity", "High Noon", "Highlander 4", "The Hills Have Eyes", "The Hindenberg", "His Girl Friday", "The Hitcher", "Hitchhiker's Guide to the Galaxy", "Hitman", "The Hollars", "Hope And Glory", "The Horse Wisperer", "The Hospital", "Hostage", "Hotel Rwanda", "House Of 1000 Corpses", "House on Haunted Hill", "How To Train Your Dragon 2", "Hudson Hawk", "The Hudsucker Proxy", "Human Nature", "The Hulk", "The Hundred Year Winter", "The Hunt For Red October", "The Hurt Locker", "Hustle & Flow", "The Hustler", "I Am Legend", "I am Sam", "I Saw The Light", "I Think I Love My Wife", "I Walked with a Zombie", "I", "Robot", "The Ice Storm", "Ides of March", "If Beale Street Could Talk", "I'll Do Anything", "Independence Day", "Indiana Jones And The Last Crusade", "Indiana Jones and the Temple of Doom", "Indiana Jones and the Raiders Of The Lost Ark", "Innerspace", "Inside Man", "Inside Out", "The Insider", "Insomnia", "Interview with the Vampire", "Intolerable Cruelty", "Inventing the Abbotts", "Investigation", "The Island", "The Island of Dr. Moreau", "Isle of the Dead", "It Happened One Night", "The Italian Job", "It's a Wonderful Life", "The Jacket", "Jackie", "Jackie Brown", "The Jackie Robinson Story", "Jacob's Ladder", "Jade", "Jane Eyre", "Jason X", "Jaws", "Jaws 2", "Jay And Silent Bob Strike Back", "Jennifer Eight", "Jerry Maguire", "JFK", "Jimmy and Judy", "John Q.", "The Jolson Story", "Julieta", "Juno", "Jurassic Park", "Jurassic Park 2: The Lost World", "Jurassic Park 3", "K-2", "Kafka", "Kalifornia", "Kate and Leopold", "Kids", "Kill Your Darlings", "King Kong", "The Kingdom", "The Kingdom of Heaven", "Kiss of the Spider Woman", "Kiss", "Kiss", "Bang", "Bang", "Klute", "Knocked Up", "Kong", "Kramer Vs. Kramer", "Kundun", "L.A. Confidential", "Lady Bird", "The Ladykillers", "Lake Placid", "Land of Mine", "Land of the Dead", "The Last Boy Scout", "Last Flag Flying", "A Last Kiss", "Last Of The Mohicans", "The Last Samurai", "The Last Temptation of Christ", "Lawrence of Arabia", "Le Grand bleu", "Leaving Las Vegas", "Legally Blonde", "Legionnaire", "The Leopard Man", "Lethal Weapon", "Lethal Weapon 4", "Lethal Weapon II", "Letters from Iwo Jima", "Letters To Juliet", "Leviathan", "Liar", "Liar", "Liberty Street", "License to Drive", "Life", "The Life and Death of Colonel Blimp", "Life As A House", "The Life of David Gale", "Life on Liberty Street", "Light Sleeper", "The Limey", "Lion", "The Lion In Winter", "Little Athens", "Little Black Book", "Little Children", "Little Miss Sunshine", "Little Nicky", "Living in Oblivion", "Locke", "Logan's Run", "Lone Star", "The Long Goodbye", "Long Kiss Goodnight", "Looking For The Man", "The Lookout", "Lord of Illusions", "The Lord of the Rings: The Return of the King", "The Lost Boys", "The Lost City of Z", "Lost Highway", "Lost Horizon", "Lost in Translation", "The Lost Weekend", "Love Actually", "Love and Basketball", "Love and Friendship", "The Lovely Bones", "M*A*S*H", "MacBeth", "MacGruber", "Made", "Made For Each Other", "Maersk Alabama", "Maggie's Plan", "Magnolia", "The Majestic", "Major League", "Malcolm X", "Malibu's Most Wanted", "The Maltese Falcon", "Man in the Iron Mask", "Man On Fire", "Man Plus", "Man Trouble", "The Man Who Knew Too Much", "The Man Who Wasn't There", "The Manchurian Candidate", "Mandingo", "Manhunter", "Maria Full of Grace", "El Mariachi", "Marty", "Matchstick Men", "The Matrix", "Maverick", "Max Payne", "Me and Earl and the Dying Girl", "Mean Girls", "Mean Streets", "The Meddler", "Meet John Doe", "Memento", "Memphis Belle", "Men In Black", "Men In Black 3", "Metro", "The Meyerowitz Stories", "Miami Vice", "Midnight Cowboy", "Midnight Express", "Midnight Run", "Mighty Joe Young", "Mighty Morphin Power Rangers", "Miles Ahead", "Miller's Crossing", "Mimic", "Mini's First Time", "Minority Report", "The Mirror Has Two Faces", "Misery", "Mission Impossible", "Mission Impossible II", "Mission to Mars", "Mississippi Grind", "Mistress America", "Mobsters", "Monkeybone", "Monster's Ball", "Moonlight", "Moonstruck", "A Most Violent Year", "mother!", "Mr. Blandings Builds His Dream House", "Mr. Deeds Goes to Town", "Mr. Holland's Opus", "Mr. Smith Goes To Washington", "Mr. Smith Goes to Washington", "Mrs. Brown", "Mulholland Drive", "Mumford", "The Mummy", "Munich", "The Muppets", "Music of the Heart", "My Mother Dreams The Satan's Disciples in New York", "Mystery Men", "Naked City", "Nashville", "Natural Born Killers", "Near Dark", "Never Been Kissed", "New Nightmare", "New York Minute", "Newsies", "Next", "Next Friday", "Nick of Time", "The Night of the Hunter", "Nightcrawler", "The Nightmare Before Christmas", "A Nightmare on Elm Street", "Nightmare on Elm Street 4: Dream Master", "Nightmare on Elm Street 5: Dream Child", "Nightmare on Elm Street 6: Freddy's Dead: The Final Nightmare", "Nightmare on Elm Street 7: Wes Craven's New Nightmare", "Nightmare On Elm Street", "A", "Ninotchka", "Nixon", "No Country For Old Men", "Noah", "Normal Adolescent Behavior", "North By Northwest", "The Number 23", "Nurse Betty", "O Brother", "Where Art Thou?", "Ocean's Eleven", "Ocean's Twelve", "Office Space", "An Officer and a Gentleman", "Officer And A Gentleman", "An", "Okja", "Omega Man", "The Omen", "On The Waterfront", "Once Upon A Time In America", "One Eight Seven", "One Flew Over The Cuckoo's Nest", "One Saliva Bubble", "Only Angels Have Wings", "Ordinary People", "Orgy of the Dead", "Out of Africa", "Out of Sight", "Out Of Time", "Outbreak", "Pacific Rim", "The Pacifier", "Panic Room", "Pan's Labyrinth", "Panther", "Paper Moon", "The Parallax View", "The Patriot", "Pearl Harbor", "Peeping Tom", "Peggy Sue Got Married", "The Perfect Neighbor", "The Perfect Stranger", "A Perfect World", "Pet Sematary", "Pet Sematary II", "Philadelphia", "Phone Booth", "PI", "The Pianist", "The Piano", "Pirates of the Caribbean", "Pitch Black", "Planet of the Apes", "Platinum Blonde", "Platoon", "Playback", "Pleasantville", "The Ploughman's Lunch", "Poltergeist", "Popeye", "Portrait of Jennie", "Possession", "The Post", "The Postman", "The Power of One", "Pray For Dawn", "Predator", "The Prestige", "Pretty Woman", "The Princess Bride", "Prisoners", "Prisoners", "The Private Life of Sherlock Homes", "The Producers", "The Program", "The Prophecy", "Psycho", "Psycho", "The Public Eye", "Pulp Fiction", "Punch Drunk Lovethe last reveal", "Quantum Project", "Quebecois!", "The Queen", "Queen of the Damned", "Quills", "Rabid", "Raging Bull", "Raiders Of The Lost Ark: Indiana Jones", "Rails & Ties", "Raising Arizona", "Rambling Rose", "Rambo: First Blood II: The Mission", "Rambo: First Blood Part II", "The Reader", "Real Genius", "Rear Window", "Rebel Without A Cause", "Red Planet", "The Red Turtle", "Reindeer Games", "The Relic", "Remember", "The Replacements", "Reservoir Dogs", "Resident Evil", "Return of the Apes", "Return to Me", "Ride the High Country", "RKO 281", "Robin Hood", "The Prince of Thieves", "Rock & Rule", "RocknRolla", "Rocky", "Rocky Balboa", "Ronin", "Room", "Room With A View", "Rough Diamonds", "Roughshod", "The Royal Tenenbaums", "The Rules of Attraction", "Rush", "Rush Hour", "Rush Hour 2", "Rushmore", "S.W.A.T.", "Saboteur", "The Saint", "St. Vincent", "The Salton Sea", "Save the Last Dance", "Saving Private Ryan", "Scarface", "Scary Movie 2", "Schindler's List", "Scream", "Scream 3", "The Searchers", "The Searchers", "Season of the Witch", "Second Act", "The Secret Life of Walter Mitty", "Secret Window", "Semi Pro", "Sense And Sensibility", "Serial Mom", "Seven", "The Seventh Victim", "Sex", "Lies and Videotapes", "Sex", "Lies", "And Videotapeinfo", "Sexual Life", "Sgt. Rock", "Shadow of the Vampire", "Shakespeare in Love", "Shampoo", "The Shawshank Redemption", "The Shining", "The Shipping News", "Shivers", "Sideways", "The Siege", "Signs", "Silence", "The Silence Of The Lambs", "Silver Bullet", "Silverado", "Simone", "Sing Street", "Singin' in the Rain", "The Sixth Sense", "Slash", "Sleepy Hollow", "Sling Blade", "SliTHER", "Slow West", "Slumdog Millionaire", "Smokey and the Bandit", "Smokin' Aces", "Snatch", "Snow Falling On Cedars", "Snow White and the Huntsman", "So I Married An Axe Murderer", "Solaris", "Soldier", "Some Like It Hot", "Something Borrowed", "Something's Gotta Give", "Somewhere", "Somewhere In Time", "Sorry", "Right Number", "South Park: Bigger", "Longer", "Uncut", "Space Cowboys", "Spanglish", "Spare Me", "Spartan", "The Spectacular Now", "Speed", "Sphere", "Spider-Man", "The Spirit of St. Louis", "Stagecoach", "Stalag 17", "Star Trek 01: The Motion Picture", "Star Trek 02: The Wrath Of Khan", "Star Trek 02: The Wrath Of Khan", "Star Trek 07: Generations", "Star Trek 08: First Contact", "Star Trek 10: Nemesis", "Starman", "State and Main", "Station", "Station West", "Stepmom", "The Sting", "Stolen Summer", "Stone My Heart", "Storytelling", "Stranger Than Fiction", "Strangers on a Train", "Stuart Little 2", "The Stunt Man", "Sugar and Spice", "Sully", "Summer of 84", "Sunset Blvd.info", "SuperFights", "Superman", "Suspect Zero", "The Sweet Hereafter", "Sweet November", "Sweet Smell of Success", "Swingers", "Swordfish", "Taking Lives", "Taking Sides", "The Talented Mr. Ripley", "Tall In The Saddle", "Tarzan's Secret Treasure", "Taxi Driver", "Tender Mercies", "Terminator", "Thelma & Louise", "The Theory of Everything", "There's Something About Mary", "Thief", "The Thin Man", "The Thing", "Thir13en Ghosts", "The Third Man", "Thirteen Days", "Thirteen Days", "Thirteen Ghosts", "This Boy's Life", "A Thousand Acres", "Three Kings", "Three Men and a Baby", "The Three Musketeers", "Three Thousand", "Thunderheart", "THX 1138", "Ticker", "The Time Machine", "Tin Cup", "Tin Men", "Titanic", "To Kill a Mockingbird", "To Sleep With Anger", "Tombstone", "Toni Erdmann", "Tootsie", "Top Gun", "Toy Story", "Traffic", "Training Day", "Trainspotting", "Trainwreck", "Transformers: The Movie", "Tremors", "TRON", "Troy", "True Believer", "True Crime", "True Romance", "The Truman Show", "Twelve Monkeys", "Twin Peaks: Fire Walk With Me", "Twins", "Two For The Money", "U Turn", "Unbreakable", "Unbroken", "Under Fire", "Unforgiven", "Untitled 50 Cent Project", "Untraceable", "The Usual Suspects", "The Utah Murder Project", "Vantage Point", "The Verdict", "Vertigo", "Very Bad Things", "Vicky Cristina Barcelona", "The Village", "Virtuosity", "Wag the Dog", "A Walk to Remember", "Wall Street", "Warm Springs", "The Wedding Crashers", "The Wedding Date", "Wes Craven's New Nightmare", "What About Bob?", "What Lies Beneath", "What to Expect When You're Expecting", "When A Stranger Calls", "When Harry Met Sally", "While We're Young", "Whiplash", "White Christmas", "Who Framed Roger Rabbit?", "Wild At Heart", "The Wild Bunch", "The Wild One", "Wild Things", "Wild Things: Diamonds in the Rough", "Wild", "Wild West", "Willow", "Wind Chill", "The Witches of Eastwick", "Withnail and I", "Witness", "Woman In Gold", "Wonder Boys", "Wonderstruck", "The Woodsman", "Wreck It Ralph", "The X-Files Movie", "X-Men", "xXx", "The Year of Living Dangerously", "You Can Count On Me", "You'll Never Die In This Town Again", "Youth", "Youth In Revolt", "You've Got Mail", "The Zero Theorem", "Zootopia")
process_movies(movie_title_list)